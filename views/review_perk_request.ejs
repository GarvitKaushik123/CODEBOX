<%- include('partials/header'); -%>

<% tempperks.forEach((e)=>{ %>
  <div class="smoothie">
    <ul>
        <h3>Title1: <%= e.title1 %></h3>
        <br>
        <h3>Title2: <%= e.title2 %></h3>
        <br>
        <h3>Details: <%= e.details %></h3>
        <br>
        <div>
          <li><button onClick="accept(this)" name="accept" data-arg1 = <%- e._id %>>Accept</button></li>
          <li><button onclick="reject(this)" name="reject" data-arg1 = <%- e._id%>>Reject</button></li> 
        </div>
    </ul>
  </div>

  <hr>
<br>
<% }) %>

<%- include('partials/footer'); -%>


<script>
  async function accept (instance){
    console.log("accept");
    console.log(instance.getAttribute('data-arg1'));
    const id = instance.getAttribute('data-arg1');

    const res = await fetch('/accept_perk', { 
        method: 'POST', 
        body: JSON.stringify({ id: id }),
        headers: {'Content-Type': 'application/json'}
    });

      const data = await res.json();
      if(data.accept){
        location.reload();
      }
  }

  async function reject (instance){
    console.log("reject");
    console.log(instance.getAttribute('data-arg1'));
    const id = instance.getAttribute('data-arg1');

      const res = await fetch('/reject_perk', { 
        method: 'POST', 
        body: JSON.stringify({ id: id }),
        headers: {'Content-Type': 'application/json'}
      });

      const data = await res.json();
      if(data.reject){
        location.reload();
      }
  }


</script>
